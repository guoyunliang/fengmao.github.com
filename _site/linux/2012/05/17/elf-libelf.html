<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
	<head>
		<meta http-equiv="content-type" content="text/html;charset=utf-8" />
		<title>elf & libelf, elftoolchain - xanpeng</title>
		<link rel="stylesheet" type="text/css" href="/css/style.css" />
		<link rel="stylesheet" type="text/css" href="/css/syntax.css" />
	</head>

	<body>
		<div id="wrapper">
			<div id="content">
				<h2>elf & libelf, elftoolchain</h2>
				<div class="cnt">
					<h1>calltrace</h1>

<p>我在看 pthreads<br/>
-> 了解进程组和线程组<br/>
-> 了解进程组的 ppid 和 pid<br/>
-> 了解 getpid 系统调用<br/>
-> 想通过 ltrace 查看 ps 调用的库函数, 从而找到 getpid 在 glibc 中的入口<br/>
-> 编译 ltrace 需要 libelf 支持<br/>
-> 放狗找 libelf 时看到 <a href="http://sourceforge.net/apps/trac/elftoolchain/">elftoolchain</a></p>

<p>elftoolchiain 维护了一个列表, 把 ld, <a href="http://en.wikipedia.org/wiki/GNU_Binutils">readelf</a>, <a href="http://en.wikipedia.org/wiki/Objdump">objdump</a>, libelf 等都包含进去了.</p>

<blockquote><p>We maintain BSD licensed implementations of essential compilation tools and libraries for handling ELF based program images.</p></blockquote>

<h1>libelf by example</h1>

<p><a href="http://mdsp.googlecode.com/files/libelf-by-example-20100112.pdf">libelf-by-example</a> 是很不错的资料, 它通过示例介绍了 libelf 的使用和 elf 的layout. 具体这里不说了, 某时再去看原文档吧(一定抽空;-)). 仅列出文档中的几个例子:</p>

<p><strong>hello, libelf</strong></p>

<script src="https://gist.github.com/2717224.js"> </script>


<p>Example: Reading an ELF executable header.<br/>
Example: Reading a Program Header Table.<br/>
Example: Listing section names.<br/>
Example: Creating an ELF object.<br/>
Example: Stepping through an ar(1) archive.</p>

<hr />

<h1>elf standards</h1>

<p>可以想见, elf 是一个协议, 它定义了一种文件格式, 诸多工具按照这个格式写入或读出. 来了解一下这个格式. 对于 64bit OS, 不同的厂商的 CPU(如同属<a href="http://en.wikipedia.org/wiki/X86-64">x86_64</a>体系结构的 Intel 的 <a href="http://en.wikipedia.org/wiki/IA-64#Architecture">IA-64</a>, 以及 AMD 的 <a href="http://en.wikipedia.org/wiki/AMD64#AMD64">AMD64</a>) 是否会对 elf 有特别的规定呢? <a href="http://en.wikipedia.org/wiki/Application_binary_interface">Application Binary Interface</a>? 还不了解, 也暂不继续 follow 了.</p>

<p><a href="http://en.wikipedia.org/wiki/Executable_and_Linkable_Format">ELF(Executable and Linkable Format)</a><br/>
<a href="http://downloads.openwatcom.org/ftp/devel/docs/elf-64-gen.pdf">ELF-64 Object File Format</a><br/>
<a href="http://www.sco.com/developers/gabi/latest/contents.html">Generic System V Application Binary Interface</a><br/>
<a href="http://www.sco.com/developers/devspecs/gabi41.pdf">Generic System V Application Binary Interface Edition4.1</a><br/>
<a href="http://www.x86-64.org/documentation/abi.pdf">AMD64 System V Application Binary Interface</a></p>

<p><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/7/77/Elf-layout--en.svg/541px-Elf-layout--en.svg.png" alt="" /></p>

<hr />

<h1>Further Reading</h1>

<p><a href="http://www.akkadia.org/drepper/dsohowto.pdf">How To Write Shared Libraries by Ulrich Drepper</a><br/>
<a href="http://developers.sun.com/solaris/articles/elf.html">LibElf and GElf - A Library to Manipulate ELf Files</a><br/>
<a href="http://linux4u.jinr.ru/usoft/WWW/www_debian.org/Documentation/elf/elf.html">ELF: From The Programmer's Perspective</a><br/>
<a href="http://linker.iecc.com/">Linkers and Loaders</a></p>

					--EOF--
				</div>
				<div id="disqus_thread"></div>
				<script type="text/javascript">
				  (function() {
				   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				   dsq.src = 'http://xanpeng.disqus.com/embed.js';
				   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
				  })();
				</script>
				<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=lzyyblog">comments powered by Disqus.</a></noscript>
			</div>
	</body>
</html>

